<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶…æ—¶åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #00ff00;
        }
        .log {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #00ff00;
        }
        .error {
            color: #ff0000;
            border-left-color: #ff0000;
        }
        .success {
            color: #00ff00;
            border-left-color: #00ff00;
        }
        .info {
            color: #ffff00;
            border-left-color: #ffff00;
        }
        #status {
            font-size: 20px;
            margin: 20px 0;
            padding: 10px;
            background: #2d2d2d;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª è¶…æ—¶åŠŸèƒ½è‡ªåŠ¨åŒ–æµ‹è¯•</h1>
    <div id="status">å‡†å¤‡æµ‹è¯•...</div>
    <div id="logs"></div>

    <script type="module">
        const logDiv = document.getElementById('logs');
        const statusDiv = document.getElementById('status');

        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            console.log(message);
        }

        function updateStatus(text) {
            statusDiv.textContent = text;
        }

        // æ¨¡æ‹Ÿ React ç»„ä»¶çš„çŠ¶æ€å’Œé€»è¾‘
        class TimerSimulator {
            constructor() {
                this.isActive = false;
                this.timeLeft = 5; // æµ‹è¯•ç”¨ 5 ç§’
                this.isOvertime = false;
                this.overtimeSeconds = 0;
                this.interval = null;
            }

            start() {
                log('â–¶ï¸ å¯åŠ¨è®¡æ—¶å™¨', 'info');
                this.isActive = true;
                this.runTimer();
            }

            runTimer() {
                if (this.interval) clearInterval(this.interval);

                if (this.isActive && !this.isOvertime && this.timeLeft > 0) {
                    log(`â±ï¸ æ­£å¸¸å€’è®¡æ—¶æ¨¡å¼: timeLeft=${this.timeLeft}`, 'info');
                    this.interval = setInterval(() => {
                        log(`  å€’è®¡æ—¶: ${this.timeLeft} -> ${this.timeLeft - 1}`, 'info');
                        
                        if (this.timeLeft <= 1) {
                            log('ğŸ”” æ—¶é—´å½’é›¶ï¼Œè§¦å‘è¶…æ—¶æ¨¡å¼', 'success');
                            this.isOvertime = true;
                            this.overtimeSeconds = 0;
                            this.timeLeft = 0;
                            
                            // é‡æ–°å¯åŠ¨å®šæ—¶å™¨è¿›å…¥è¶…æ—¶æ¨¡å¼
                            clearInterval(this.interval);
                            this.runTimer();
                            return;
                        }
                        
                        this.timeLeft--;
                    }, 1000);
                } else if (this.isActive && this.isOvertime) {
                    log('âœ¨ è¶…æ—¶æ­£å‘è®¡æ—¶æ¨¡å¼å¯åŠ¨', 'success');
                    this.interval = setInterval(() => {
                        this.overtimeSeconds++;
                        log(`  è¶…æ—¶è®¡æ—¶: ${this.overtimeSeconds} ç§’`, 'success');
                        
                        if (this.overtimeSeconds >= 5) {
                            log('âœ… æµ‹è¯•å®Œæˆï¼šè¶…æ—¶è®¡æ—¶æ­£å¸¸å·¥ä½œï¼', 'success');
                            this.stop();
                        }
                    }, 1000);
                } else {
                    log('âŒ é”™è¯¯ï¼šæ— æ³•å¯åŠ¨è®¡æ—¶å™¨', 'error');
                    log(`  çŠ¶æ€: isActive=${this.isActive}, isOvertime=${this.isOvertime}, timeLeft=${this.timeLeft}`, 'error');
                }
            }

            stop() {
                if (this.interval) {
                    clearInterval(this.interval);
                    this.interval = null;
                }
                this.isActive = false;
                updateStatus('âœ… æµ‹è¯•å®Œæˆ');
            }
        }

        // è¿è¡Œæµ‹è¯•
        async function runTest() {
            log('ğŸš€ å¼€å§‹æµ‹è¯•è¶…æ—¶åŠŸèƒ½', 'info');
            updateStatus('ğŸ§ª æµ‹è¯•è¿›è¡Œä¸­...');
            
            const timer = new TimerSimulator();
            timer.start();
        }

        // å¯åŠ¨æµ‹è¯•
        runTest();
    </script>
</body>
</html>
